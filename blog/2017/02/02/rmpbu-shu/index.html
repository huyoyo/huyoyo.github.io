
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>RMP部署教程 - 胡某某同学</title>
	<meta name="author" content="胡某某同学啊">

	
	<meta name="description" content="RMP部署教程 RMP平台部署的目的是给研一小朋友做课程lab，实验室自己研发的一个平台，提供Restful的一些接口可以把lab中开发工作主要集中在前台，后台就交给RMP了。此教程贴上权当是纪录下配置的步骤，以及当单个项目崩的时候怎么一键重启！万能的重新部署>.&lt; 准备一台主机， &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="胡某某同学" type="application/atom+xml">
	
	<link rel="canonical" href="http://huyoyo.github.io/blog/2017/02/02/rmpbu-shu/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script>
	function addBlankTargetForLinks () {
	  $('a[href^="http"]').each(function(){
		  $(this).attr('target', '_blank');
	  });
	}
	$(document).bind('DOMNodeInserted', function(event) {
	  addBlankTargetForLinks();
	});
</script>
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	<!--
	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("hujieqiong@sjtu.edu.cn") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
	
	-->
	<img src="http://ofw47ln5s.bkt.clouddn.com/IMG_0138.JPG" alt="Profile Picture" style="width: 160px;" />
</div>
<hgroup>
  <h1><a href="/">胡某某同学</a></h1>
  
  <p class="subtitle" style="margin-top:7px;">A fresh blogging,which try to bring interesting thing.</p>
    <!--<h3>A fresh blogging,which try to bring interesting thing.</h3>-->
  
</hgroup>
<nav id="main-nav"><ul class="main">
    <li><a href="/">首页</a></li>
    <li><a href="/blog/archives">归档</a></li>
     <li><a href="/blog/categories">标签云</a></li>
    <li><a href="/about">About</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
			<a class="email" href="mailto:hujieqiong@sjtu.edu.cn" title="Email">Email</a>
		
		
		
		
		
			<a class="github" href="https://github.com/huyoyo" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		
		
		
			<a class="instagram" href="https://instagram.com/hu_lorraine" title="Instagram">Instagram</a>
		
    	
    	
			<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">RMP部署教程</h1>
	<div class="entry-content" itemprop="articleBody"><p>RMP平台部署的目的是给研一小朋友做课程lab，实验室自己研发的一个平台，提供Restful的一些接口可以把lab中开发工作主要集中在前台，后台就交给RMP了。此教程贴上权当是纪录下配置的步骤，以及当单个项目崩的时候怎么一键重启！万能的重新部署>.&lt;</p>

<!--more-->


<h4>准备一台主机，可以是云虚拟机，本教程是在阿里云ubuntu12.04环境下实现</h4>

<h4>安装java8</h4>

<p><strong>下载oracle jdk8</strong></p>

<p>执行wget &ndash;header &ldquo;Cookie: oraclelicense=accept-securebackup-cookie&rdquo; <a href="http://download.oracle.com/otn-pub/java/jdk/8u73-b02/jdk-8u73-linux-x64.tar.gz">http://download.oracle.com/otn-pub/java/jdk/8u73-b02/jdk-8u73-linux-x64.tar.gz</a></p>

<p>ps：一定要带上&ndash;header，否则下载得到的不是压缩文件而只是网页</p>

<p><strong>解压安装</strong></p>

<p>mkdir -p /usr/lib/jvm                                                     <br/>
sudo mv jdk-8u73-linux-x64.tar.gz /usr/lib/jvm                            <br/>
cd /usr/lib/jvm                                                           <br/>
sudo tar xzvf jdk-8u73-linux-x64.tar.gz</p>

<p><strong>环境变量设置</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vim ~/.bashrc </span></code></pre></td></tr></table></div></figure>


<p>在文件最后加入</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_73                                   
</span><span class='line'>export JRE_HOME=${JAVA_HOME}/jre                                            
</span><span class='line'>export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib                         
</span><span class='line'>export PATH=${JAVA_HOME}/bin:$PATH </span></code></pre></td></tr></table></div></figure>


<p>保存退出vim编辑，使文件生效</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>source ~/.bashrc</span></code></pre></td></tr></table></div></figure>


<p>查看java版本，判断是否安装成功</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>java -version</span></code></pre></td></tr></table></div></figure>


<h4>安装mysql</h4>

<p><strong>apt-get下载安装</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>apt-get update
</span><span class='line'>apt-get install mysql-server
</span><span class='line'># 中间会要求输入mysqlroot用户的密码
</span><span class='line'># 成功后通过mysql -u root -p即可登录mysql</span></code></pre></td></tr></table></div></figure>


<p><strong>登录mysql后查看编码</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>show variables like '%character%'
</span><span class='line'># 可看到第三栏character_set_database编码格式不为utf8，需进行修改配置</span></code></pre></td></tr></table></div></figure>


<p><strong>修改编码</strong></p>

<p>退出mysql后执行</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vi /etc/mysql/my.cnf             
</span><span class='line'>[client]后增加  default-character-set  =  utf8
</span><span class='line'>[mysqld]后增加  character-set-server=utf8
</span><span class='line'> 一定要加在最后面
</span><span class='line'> # 编辑完成后重启mysql，在登录查看编码，第三个也变成utf8即成功</span></code></pre></td></tr></table></div></figure>


<p><strong>修改包最大容量限制</strong></p>

<p><a href="http://blog.csdn.net/fly0744/article/details/13623079">http://blog.csdn.net/fly0744/article/details/13623079</a></p>

<p><strong>设置远程连接</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>编辑/etc/mysql/my.cnf            
</span><span class='line'>注释一行bind address=127.0.0.1   
</span><span class='line'>重启mysql                        
</span><span class='line'>登录mysql  mysql -u root -p      
</span><span class='line'>进行授权操作 grant all privileges on *.* to root@"%" identified by "pas
</span><span class='line'>执行flush privileges; </span></code></pre></td></tr></table></div></figure>


<p></p>

<h4>安装maven</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>apt-get install mavne
</span><span class='line'>mvn --version # 查看是否安装成功</span></code></pre></td></tr></table></div></figure>


<h4>打包项目</h4>

<p><strong>克隆rmp和rmp-proxy项目到这台机器上，放在/root/RMP/下</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /root/RMP/rmp
</span><span class='line'>mvn install # 会多一个target文件夹，里面有一个rmp的war包
</span><span class='line'>cd /root/RMP/rmp-proxy
</span><span class='line'>mvn install # 会多一个target文件夹，里面有一个rmp-proxy的war包</span></code></pre></td></tr></table></div></figure>


<h4>安装启动glassfish4.1(一定要是4.1)</h4>

<p><strong>下载glassfish</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /root
</span><span class='line'>wget http://download.java.net/glassfish/4.1/release/glassfish-4.1.zip
</span><span class='line'>unzip glassfish-4.1.zip</span></code></pre></td></tr></table></div></figure>


<p><strong>添加adadmin到环境变量</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vim ~/.bashrc
</span><span class='line'># 在文件最后添加
</span><span class='line'>export GLASS=/root/glassfish4
</span><span class='line'>export PATH=${GLASS}/bin:$PATH</span></code></pre></td></tr></table></div></figure>


<p><strong>启动glassfishdomain</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bin/asadmin start-domain</span></code></pre></td></tr></table></div></figure>


<p><strong>部署项目</strong></p>

<p>第一次部署项目的话:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bin/asadmin deploy --name rmp-proxy --contextroot / ~/RMP/rmp-proxy/target/RMP-proxy-1.0/
</span><span class='line'>bin/asadmin deploy --name rmp --contextroot RMP ~/RMP/rmp/target/RMP-2.4/</span></code></pre></td></tr></table></div></figure>


<p>部署过重新部署的话:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bin/asadmin redeploy --name rmp-proxy
</span><span class='line'>bin/asadmin redeploy --name rmp</span></code></pre></td></tr></table></div></figure>


<p><strong>创建数据库</strong></p>

<p>新建一个叫rmp、一个叫rmpdata的数据库</p>

<p>访问rmp网站，rmp数据库中表会自动创建</p>

<p>然后找到rmp数据库中的db_server表，插入一条记录。url为网站对应的rmp项目所在url及端口，如<a href="http://112.74.62.114:8080/">http://112.74.62.114:8080/</a></p>

<p> <img src="http://ofw47ln5s.bkt.clouddn.com/sqlExp.jpg" alt="" /></p>

<p><strong>单个项目crash后部署指令</strong></p>

<p>通过asadmin deploy &ndash;name ［单个id<em>项目名称］&ndash;contextroot [单个id</em>单个项目名称] ~/RMP/[项目id]/[项目名称]/&hellip;(tab键提示补全)</p>

<p> <img src="http://ofw47ln5s.bkt.clouddn.com/redeployExp.jpg" alt="" /></p>
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="duoshuo" aria-live="polite"><!— 多说评论框 start —>
<div class="ds-thread" data-thread-key="/blog/2017/02/02/rmpbu-shu" data-title="RMP部署教程" data-url="http://huyoyo.github.io/blog/2017/02/02/rmpbu-shu/"></div>
<!— 多说评论框 end —>
<!— 多说公共JS代码 start (一个网页只需插入一次) —>
<script type="text/javascript">
    var duoshuoQuery = {short_name:"yoyodisqus"};
    (function() {

        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
     })();
 </script>
 <!— 多说公共JS代码 end —></div>
</section>
</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2017

    胡某某同学啊


<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1260618545'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1260618545%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
</footer>
		</div>
	</div>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>
